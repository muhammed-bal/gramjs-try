{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.computeDigest = exports.computeCheck = void 0;\nconst buffer_1 = require(\"buffer/\");\nconst tl_1 = require(\"./tl\");\nconst Helpers_1 = require(\"./Helpers\");\nconst big_integer_1 = __importDefault(require(\"big-integer\"));\nconst CryptoFile_1 = __importDefault(require(\"./CryptoFile\"));\nconst SIZE_FOR_HASH = 256;\n/**\r\n *\r\n *\r\n * @param prime{BigInteger}\r\n * @param g{BigInteger}\r\n */\n/*\r\nWe don't support changing passwords yet\r\nfunction checkPrimeAndGoodCheck(prime, g) {\r\n    console.error('Unsupported function `checkPrimeAndGoodCheck` call. Arguments:', prime, g)\r\n\r\n    const goodPrimeBitsCount = 2048\r\n    if (prime < 0 || prime.bitLength() !== goodPrimeBitsCount) {\r\n        throw new Error(`bad prime count ${prime.bitLength()},expected ${goodPrimeBitsCount}`)\r\n    }\r\n    // TODO this is kinda slow\r\n    if (Factorizator.factorize(prime)[0] !== 1) {\r\n        throw new Error('give \"prime\" is not prime')\r\n    }\r\n    if (g.eq(bigInt(2))) {\r\n        if ((prime.remainder(bigInt(8))).neq(bigInt(7))) {\r\n            throw new Error(`bad g ${g}, mod8 ${prime % 8}`)\r\n        }\r\n    } else if (g.eq(bigInt(3))) {\r\n        if ((prime.remainder(bigInt(3))).neq(bigInt(2))) {\r\n            throw new Error(`bad g ${g}, mod3 ${prime % 3}`)\r\n        }\r\n        // eslint-disable-next-line no-empty\r\n    } else if (g.eq(bigInt(4))) {\r\n\r\n    } else if (g.eq(bigInt(5))) {\r\n        if (!([ bigInt(1), bigInt(4) ].includes(prime.remainder(bigInt(5))))) {\r\n            throw new Error(`bad g ${g}, mod8 ${prime % 5}`)\r\n        }\r\n    } else if (g.eq(bigInt(6))) {\r\n        if (!([ bigInt(19), bigInt(23) ].includes(prime.remainder(bigInt(24))))) {\r\n            throw new Error(`bad g ${g}, mod8 ${prime % 24}`)\r\n        }\r\n    } else if (g.eq(bigInt(7))) {\r\n        if (!([ bigInt(3), bigInt(5), bigInt(6) ].includes(prime.remainder(bigInt(7))))) {\r\n            throw new Error(`bad g ${g}, mod8 ${prime % 7}`)\r\n        }\r\n    } else {\r\n        throw new Error(`bad g ${g}`)\r\n    }\r\n    const primeSub1Div2 = (prime.subtract(bigInt(1))).divide(bigInt(2))\r\n    if (Factorizator.factorize(primeSub1Div2)[0] !== 1) {\r\n        throw new Error('(prime - 1) // 2 is not prime')\r\n    }\r\n}\r\n*/\n/**\r\n *\r\n * @param primeBytes{Buffer}\r\n * @param g{number}\r\n */\nfunction checkPrimeAndGood(primeBytes, g) {\n  const goodPrime = buffer_1.Buffer.from([0xc7, 0x1c, 0xae, 0xb9, 0xc6, 0xb1, 0xc9, 0x04, 0x8e, 0x6c, 0x52, 0x2f, 0x70, 0xf1, 0x3f, 0x73, 0x98, 0x0d, 0x40, 0x23, 0x8e, 0x3e, 0x21, 0xc1, 0x49, 0x34, 0xd0, 0x37, 0x56, 0x3d, 0x93, 0x0f, 0x48, 0x19, 0x8a, 0x0a, 0xa7, 0xc1, 0x40, 0x58, 0x22, 0x94, 0x93, 0xd2, 0x25, 0x30, 0xf4, 0xdb, 0xfa, 0x33, 0x6f, 0x6e, 0x0a, 0xc9, 0x25, 0x13, 0x95, 0x43, 0xae, 0xd4, 0x4c, 0xce, 0x7c, 0x37, 0x20, 0xfd, 0x51, 0xf6, 0x94, 0x58, 0x70, 0x5a, 0xc6, 0x8c, 0xd4, 0xfe, 0x6b, 0x6b, 0x13, 0xab, 0xdc, 0x97, 0x46, 0x51, 0x29, 0x69, 0x32, 0x84, 0x54, 0xf1, 0x8f, 0xaf, 0x8c, 0x59, 0x5f, 0x64, 0x24, 0x77, 0xfe, 0x96, 0xbb, 0x2a, 0x94, 0x1d, 0x5b, 0xcd, 0x1d, 0x4a, 0xc8, 0xcc, 0x49, 0x88, 0x07, 0x08, 0xfa, 0x9b, 0x37, 0x8e, 0x3c, 0x4f, 0x3a, 0x90, 0x60, 0xbe, 0xe6, 0x7c, 0xf9, 0xa4, 0xa4, 0xa6, 0x95, 0x81, 0x10, 0x51, 0x90, 0x7e, 0x16, 0x27, 0x53, 0xb5, 0x6b, 0x0f, 0x6b, 0x41, 0x0d, 0xba, 0x74, 0xd8, 0xa8, 0x4b, 0x2a, 0x14, 0xb3, 0x14, 0x4e, 0x0e, 0xf1, 0x28, 0x47, 0x54, 0xfd, 0x17, 0xed, 0x95, 0x0d, 0x59, 0x65, 0xb4, 0xb9, 0xdd, 0x46, 0x58, 0x2d, 0xb1, 0x17, 0x8d, 0x16, 0x9c, 0x6b, 0xc4, 0x65, 0xb0, 0xd6, 0xff, 0x9c, 0xa3, 0x92, 0x8f, 0xef, 0x5b, 0x9a, 0xe4, 0xe4, 0x18, 0xfc, 0x15, 0xe8, 0x3e, 0xbe, 0xa0, 0xf8, 0x7f, 0xa9, 0xff, 0x5e, 0xed, 0x70, 0x05, 0x0d, 0xed, 0x28, 0x49, 0xf4, 0x7b, 0xf9, 0x59, 0xd9, 0x56, 0x85, 0x0c, 0xe9, 0x29, 0x85, 0x1f, 0x0d, 0x81, 0x15, 0xf6, 0x35, 0xb1, 0x05, 0xee, 0x2e, 0x4e, 0x15, 0xd0, 0x4b, 0x24, 0x54, 0xbf, 0x6f, 0x4f, 0xad, 0xf0, 0x34, 0xb1, 0x04, 0x03, 0x11, 0x9c, 0xd8, 0xe3, 0xb9, 0x2f, 0xcc, 0x5b]);\n  if (goodPrime.equals(primeBytes)) {\n    if ([3, 4, 5, 7].includes(g)) {\n      return; // It's good\n    }\n  }\n\n  throw new Error(\"Changing passwords unsupported\");\n  //checkPrimeAndGoodCheck(readBigIntFromBuffer(primeBytes, false), g)\n}\n/**\r\n *\r\n * @param number{BigInteger}\r\n * @param p{BigInteger}\r\n * @returns {boolean}\r\n */\nfunction isGoodLarge(number, p) {\n  return number.greater((0, big_integer_1.default)(0)) && p.subtract(number).greater((0, big_integer_1.default)(0));\n}\n/**\r\n *\r\n * @param number {Buffer}\r\n * @returns {Buffer}\r\n */\nfunction numBytesForHash(number) {\n  return buffer_1.Buffer.concat([buffer_1.Buffer.alloc(SIZE_FOR_HASH - number.length), number]);\n}\n/**\r\n *\r\n * @param g {bigInt}\r\n * @returns {Buffer}\r\n */\nfunction bigNumForHash(g) {\n  return (0, Helpers_1.readBufferFromBigInt)(g, SIZE_FOR_HASH, false);\n}\n/**\r\n *\r\n * @param modexp {BigInteger}\r\n * @param prime {BigInteger}\r\n * @returns {Boolean}\r\n */\nfunction isGoodModExpFirst(modexp, prime) {\n  const diff = prime.subtract(modexp);\n  const minDiffBitsCount = 2048 - 64;\n  const maxModExpSize = 256;\n  return !(diff.lesser((0, big_integer_1.default)(0)) || diff.bitLength().toJSNumber() < minDiffBitsCount || modexp.bitLength().toJSNumber() < minDiffBitsCount || Math.floor((modexp.bitLength().toJSNumber() + 7) / 8) > maxModExpSize);\n}\nfunction xor(a, b) {\n  const length = Math.min(a.length, b.length);\n  for (let i = 0; i < length; i++) {\n    a[i] = a[i] ^ b[i];\n  }\n  return a;\n}\n/**\r\n *\r\n * @param password{Buffer}\r\n * @param salt{Buffer}\r\n * @param iterations{number}\r\n * @returns {*}\r\n */\nfunction pbkdf2sha512(password, salt, iterations) {\n  return CryptoFile_1.default.pbkdf2Sync(password, salt, iterations, 64, \"sha512\");\n}\n/**\r\n *\r\n * @param algo {constructors.PasswordKdfAlgoSHA256SHA256PBKDF2HMACSHA512iter100000SHA256ModPow}\r\n * @param password\r\n * @returns {Buffer|*}\r\n */\nasync function computeHash(algo, password) {\n  const hash1 = await (0, Helpers_1.sha256)(buffer_1.Buffer.concat([algo.salt1, buffer_1.Buffer.from(password, \"utf-8\"), algo.salt1]));\n  const hash2 = await (0, Helpers_1.sha256)(buffer_1.Buffer.concat([algo.salt2, hash1, algo.salt2]));\n  const hash3 = await pbkdf2sha512(hash2, algo.salt1, 100000);\n  return (0, Helpers_1.sha256)(buffer_1.Buffer.concat([algo.salt2, hash3, algo.salt2]));\n}\n/**\r\n *\r\n * @param algo {constructors.PasswordKdfAlgoSHA256SHA256PBKDF2HMACSHA512iter100000SHA256ModPow}\r\n * @param password\r\n */\nasync function computeDigest(algo, password) {\n  try {\n    checkPrimeAndGood(algo.p, algo.g);\n  } catch (e) {\n    throw new Error(\"bad p/g in password\");\n  }\n  const value = (0, Helpers_1.modExp)((0, big_integer_1.default)(algo.g), (0, Helpers_1.readBigIntFromBuffer)(await computeHash(algo, password), false), (0, Helpers_1.readBigIntFromBuffer)(algo.p, false));\n  return bigNumForHash(value);\n}\nexports.computeDigest = computeDigest;\n/**\r\n *\r\n * @param request {constructors.account.Password}\r\n * @param password {string}\r\n */\nasync function computeCheck(request, password) {\n  const algo = request.currentAlgo;\n  if (!(algo instanceof tl_1.Api.PasswordKdfAlgoSHA256SHA256PBKDF2HMACSHA512iter100000SHA256ModPow)) {\n    throw new Error(`Unsupported password algorithm ${algo === null || algo === void 0 ? void 0 : algo.className}`);\n  }\n  const srp_B = request.srp_B;\n  const srpId = request.srpId;\n  if (!srp_B || !srpId) {\n    throw new Error(`Undefined srp_b  ${request}`);\n  }\n  const pwHash = await computeHash(algo, password);\n  const p = (0, Helpers_1.readBigIntFromBuffer)(algo.p, false);\n  const g = algo.g;\n  const B = (0, Helpers_1.readBigIntFromBuffer)(srp_B, false);\n  try {\n    checkPrimeAndGood(algo.p, g);\n  } catch (e) {\n    throw new Error(\"bad /g in password\");\n  }\n  if (!isGoodLarge(B, p)) {\n    throw new Error(\"bad b in check\");\n  }\n  const x = (0, Helpers_1.readBigIntFromBuffer)(pwHash, false);\n  const pForHash = numBytesForHash(algo.p);\n  const gForHash = bigNumForHash((0, big_integer_1.default)(g));\n  const bForHash = numBytesForHash(srp_B);\n  const gX = (0, Helpers_1.modExp)((0, big_integer_1.default)(g), x, p);\n  const k = (0, Helpers_1.readBigIntFromBuffer)(await (0, Helpers_1.sha256)(buffer_1.Buffer.concat([pForHash, gForHash])), false);\n  const kgX = (0, Helpers_1.bigIntMod)(k.multiply(gX), p);\n  const generateAndCheckRandom = async () => {\n    const randomSize = 256;\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n      const random = (0, Helpers_1.generateRandomBytes)(randomSize);\n      const a = (0, Helpers_1.readBigIntFromBuffer)(random, false);\n      const A = (0, Helpers_1.modExp)((0, big_integer_1.default)(g), a, p);\n      if (isGoodModExpFirst(A, p)) {\n        const aForHash = bigNumForHash(A);\n        const u = (0, Helpers_1.readBigIntFromBuffer)(await (0, Helpers_1.sha256)(buffer_1.Buffer.concat([aForHash, bForHash])), false);\n        if (u.greater((0, big_integer_1.default)(0))) {\n          return {\n            a: a,\n            aForHash: aForHash,\n            u: u\n          };\n        }\n      }\n    }\n  };\n  const {\n    a,\n    aForHash,\n    u\n  } = await generateAndCheckRandom();\n  const gB = (0, Helpers_1.bigIntMod)(B.subtract(kgX), p);\n  if (!isGoodModExpFirst(gB, p)) {\n    throw new Error(\"bad gB\");\n  }\n  const ux = u.multiply(x);\n  const aUx = a.add(ux);\n  const S = (0, Helpers_1.modExp)(gB, aUx, p);\n  const [K, pSha, gSha, salt1Sha, salt2Sha] = await Promise.all([(0, Helpers_1.sha256)(bigNumForHash(S)), (0, Helpers_1.sha256)(pForHash), (0, Helpers_1.sha256)(gForHash), (0, Helpers_1.sha256)(algo.salt1), (0, Helpers_1.sha256)(algo.salt2)]);\n  const M1 = await (0, Helpers_1.sha256)(buffer_1.Buffer.concat([xor(pSha, gSha), salt1Sha, salt2Sha, aForHash, bForHash, K]));\n  return new tl_1.Api.InputCheckPasswordSRP({\n    srpId: srpId,\n    A: buffer_1.Buffer.from(aForHash),\n    M1: M1\n  });\n}\nexports.computeCheck = computeCheck;","map":{"version":3,"names":["__importDefault","mod","__esModule","Object","defineProperty","exports","value","computeDigest","computeCheck","buffer_1","require","tl_1","Helpers_1","big_integer_1","CryptoFile_1","SIZE_FOR_HASH","checkPrimeAndGood","primeBytes","g","goodPrime","Buffer","from","equals","includes","Error","isGoodLarge","number","p","greater","default","subtract","numBytesForHash","concat","alloc","length","bigNumForHash","readBufferFromBigInt","isGoodModExpFirst","modexp","prime","diff","minDiffBitsCount","maxModExpSize","lesser","bitLength","toJSNumber","Math","floor","xor","a","b","min","i","pbkdf2sha512","password","salt","iterations","pbkdf2Sync","computeHash","algo","hash1","sha256","salt1","hash2","salt2","hash3","e","modExp","readBigIntFromBuffer","request","currentAlgo","Api","PasswordKdfAlgoSHA256SHA256PBKDF2HMACSHA512iter100000SHA256ModPow","className","srp_B","srpId","pwHash","B","x","pForHash","gForHash","bForHash","gX","k","kgX","bigIntMod","multiply","generateAndCheckRandom","randomSize","random","generateRandomBytes","A","aForHash","u","gB","ux","aUx","add","S","K","pSha","gSha","salt1Sha","salt2Sha","Promise","all","M1","InputCheckPasswordSRP"],"sources":["C:/Users/Muhammed/Desktop/REACT_JS/dene-gramjs/node_modules/telegram/Password.js"],"sourcesContent":["\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.computeDigest = exports.computeCheck = void 0;\r\nconst buffer_1 = require(\"buffer/\");\r\nconst tl_1 = require(\"./tl\");\r\nconst Helpers_1 = require(\"./Helpers\");\r\nconst big_integer_1 = __importDefault(require(\"big-integer\"));\r\nconst CryptoFile_1 = __importDefault(require(\"./CryptoFile\"));\r\nconst SIZE_FOR_HASH = 256;\r\n/**\r\n *\r\n *\r\n * @param prime{BigInteger}\r\n * @param g{BigInteger}\r\n */\r\n/*\r\nWe don't support changing passwords yet\r\nfunction checkPrimeAndGoodCheck(prime, g) {\r\n    console.error('Unsupported function `checkPrimeAndGoodCheck` call. Arguments:', prime, g)\r\n\r\n    const goodPrimeBitsCount = 2048\r\n    if (prime < 0 || prime.bitLength() !== goodPrimeBitsCount) {\r\n        throw new Error(`bad prime count ${prime.bitLength()},expected ${goodPrimeBitsCount}`)\r\n    }\r\n    // TODO this is kinda slow\r\n    if (Factorizator.factorize(prime)[0] !== 1) {\r\n        throw new Error('give \"prime\" is not prime')\r\n    }\r\n    if (g.eq(bigInt(2))) {\r\n        if ((prime.remainder(bigInt(8))).neq(bigInt(7))) {\r\n            throw new Error(`bad g ${g}, mod8 ${prime % 8}`)\r\n        }\r\n    } else if (g.eq(bigInt(3))) {\r\n        if ((prime.remainder(bigInt(3))).neq(bigInt(2))) {\r\n            throw new Error(`bad g ${g}, mod3 ${prime % 3}`)\r\n        }\r\n        // eslint-disable-next-line no-empty\r\n    } else if (g.eq(bigInt(4))) {\r\n\r\n    } else if (g.eq(bigInt(5))) {\r\n        if (!([ bigInt(1), bigInt(4) ].includes(prime.remainder(bigInt(5))))) {\r\n            throw new Error(`bad g ${g}, mod8 ${prime % 5}`)\r\n        }\r\n    } else if (g.eq(bigInt(6))) {\r\n        if (!([ bigInt(19), bigInt(23) ].includes(prime.remainder(bigInt(24))))) {\r\n            throw new Error(`bad g ${g}, mod8 ${prime % 24}`)\r\n        }\r\n    } else if (g.eq(bigInt(7))) {\r\n        if (!([ bigInt(3), bigInt(5), bigInt(6) ].includes(prime.remainder(bigInt(7))))) {\r\n            throw new Error(`bad g ${g}, mod8 ${prime % 7}`)\r\n        }\r\n    } else {\r\n        throw new Error(`bad g ${g}`)\r\n    }\r\n    const primeSub1Div2 = (prime.subtract(bigInt(1))).divide(bigInt(2))\r\n    if (Factorizator.factorize(primeSub1Div2)[0] !== 1) {\r\n        throw new Error('(prime - 1) // 2 is not prime')\r\n    }\r\n}\r\n*/\r\n/**\r\n *\r\n * @param primeBytes{Buffer}\r\n * @param g{number}\r\n */\r\nfunction checkPrimeAndGood(primeBytes, g) {\r\n    const goodPrime = buffer_1.Buffer.from([\r\n        0xc7, 0x1c, 0xae, 0xb9, 0xc6, 0xb1, 0xc9, 0x04, 0x8e, 0x6c, 0x52, 0x2f,\r\n        0x70, 0xf1, 0x3f, 0x73, 0x98, 0x0d, 0x40, 0x23, 0x8e, 0x3e, 0x21, 0xc1,\r\n        0x49, 0x34, 0xd0, 0x37, 0x56, 0x3d, 0x93, 0x0f, 0x48, 0x19, 0x8a, 0x0a,\r\n        0xa7, 0xc1, 0x40, 0x58, 0x22, 0x94, 0x93, 0xd2, 0x25, 0x30, 0xf4, 0xdb,\r\n        0xfa, 0x33, 0x6f, 0x6e, 0x0a, 0xc9, 0x25, 0x13, 0x95, 0x43, 0xae, 0xd4,\r\n        0x4c, 0xce, 0x7c, 0x37, 0x20, 0xfd, 0x51, 0xf6, 0x94, 0x58, 0x70, 0x5a,\r\n        0xc6, 0x8c, 0xd4, 0xfe, 0x6b, 0x6b, 0x13, 0xab, 0xdc, 0x97, 0x46, 0x51,\r\n        0x29, 0x69, 0x32, 0x84, 0x54, 0xf1, 0x8f, 0xaf, 0x8c, 0x59, 0x5f, 0x64,\r\n        0x24, 0x77, 0xfe, 0x96, 0xbb, 0x2a, 0x94, 0x1d, 0x5b, 0xcd, 0x1d, 0x4a,\r\n        0xc8, 0xcc, 0x49, 0x88, 0x07, 0x08, 0xfa, 0x9b, 0x37, 0x8e, 0x3c, 0x4f,\r\n        0x3a, 0x90, 0x60, 0xbe, 0xe6, 0x7c, 0xf9, 0xa4, 0xa4, 0xa6, 0x95, 0x81,\r\n        0x10, 0x51, 0x90, 0x7e, 0x16, 0x27, 0x53, 0xb5, 0x6b, 0x0f, 0x6b, 0x41,\r\n        0x0d, 0xba, 0x74, 0xd8, 0xa8, 0x4b, 0x2a, 0x14, 0xb3, 0x14, 0x4e, 0x0e,\r\n        0xf1, 0x28, 0x47, 0x54, 0xfd, 0x17, 0xed, 0x95, 0x0d, 0x59, 0x65, 0xb4,\r\n        0xb9, 0xdd, 0x46, 0x58, 0x2d, 0xb1, 0x17, 0x8d, 0x16, 0x9c, 0x6b, 0xc4,\r\n        0x65, 0xb0, 0xd6, 0xff, 0x9c, 0xa3, 0x92, 0x8f, 0xef, 0x5b, 0x9a, 0xe4,\r\n        0xe4, 0x18, 0xfc, 0x15, 0xe8, 0x3e, 0xbe, 0xa0, 0xf8, 0x7f, 0xa9, 0xff,\r\n        0x5e, 0xed, 0x70, 0x05, 0x0d, 0xed, 0x28, 0x49, 0xf4, 0x7b, 0xf9, 0x59,\r\n        0xd9, 0x56, 0x85, 0x0c, 0xe9, 0x29, 0x85, 0x1f, 0x0d, 0x81, 0x15, 0xf6,\r\n        0x35, 0xb1, 0x05, 0xee, 0x2e, 0x4e, 0x15, 0xd0, 0x4b, 0x24, 0x54, 0xbf,\r\n        0x6f, 0x4f, 0xad, 0xf0, 0x34, 0xb1, 0x04, 0x03, 0x11, 0x9c, 0xd8, 0xe3,\r\n        0xb9, 0x2f, 0xcc, 0x5b,\r\n    ]);\r\n    if (goodPrime.equals(primeBytes)) {\r\n        if ([3, 4, 5, 7].includes(g)) {\r\n            return; // It's good\r\n        }\r\n    }\r\n    throw new Error(\"Changing passwords unsupported\");\r\n    //checkPrimeAndGoodCheck(readBigIntFromBuffer(primeBytes, false), g)\r\n}\r\n/**\r\n *\r\n * @param number{BigInteger}\r\n * @param p{BigInteger}\r\n * @returns {boolean}\r\n */\r\nfunction isGoodLarge(number, p) {\r\n    return number.greater((0, big_integer_1.default)(0)) && p.subtract(number).greater((0, big_integer_1.default)(0));\r\n}\r\n/**\r\n *\r\n * @param number {Buffer}\r\n * @returns {Buffer}\r\n */\r\nfunction numBytesForHash(number) {\r\n    return buffer_1.Buffer.concat([buffer_1.Buffer.alloc(SIZE_FOR_HASH - number.length), number]);\r\n}\r\n/**\r\n *\r\n * @param g {bigInt}\r\n * @returns {Buffer}\r\n */\r\nfunction bigNumForHash(g) {\r\n    return (0, Helpers_1.readBufferFromBigInt)(g, SIZE_FOR_HASH, false);\r\n}\r\n/**\r\n *\r\n * @param modexp {BigInteger}\r\n * @param prime {BigInteger}\r\n * @returns {Boolean}\r\n */\r\nfunction isGoodModExpFirst(modexp, prime) {\r\n    const diff = prime.subtract(modexp);\r\n    const minDiffBitsCount = 2048 - 64;\r\n    const maxModExpSize = 256;\r\n    return !(diff.lesser((0, big_integer_1.default)(0)) ||\r\n        diff.bitLength().toJSNumber() < minDiffBitsCount ||\r\n        modexp.bitLength().toJSNumber() < minDiffBitsCount ||\r\n        Math.floor((modexp.bitLength().toJSNumber() + 7) / 8) > maxModExpSize);\r\n}\r\nfunction xor(a, b) {\r\n    const length = Math.min(a.length, b.length);\r\n    for (let i = 0; i < length; i++) {\r\n        a[i] = a[i] ^ b[i];\r\n    }\r\n    return a;\r\n}\r\n/**\r\n *\r\n * @param password{Buffer}\r\n * @param salt{Buffer}\r\n * @param iterations{number}\r\n * @returns {*}\r\n */\r\nfunction pbkdf2sha512(password, salt, iterations) {\r\n    return CryptoFile_1.default.pbkdf2Sync(password, salt, iterations, 64, \"sha512\");\r\n}\r\n/**\r\n *\r\n * @param algo {constructors.PasswordKdfAlgoSHA256SHA256PBKDF2HMACSHA512iter100000SHA256ModPow}\r\n * @param password\r\n * @returns {Buffer|*}\r\n */\r\nasync function computeHash(algo, password) {\r\n    const hash1 = await (0, Helpers_1.sha256)(buffer_1.Buffer.concat([algo.salt1, buffer_1.Buffer.from(password, \"utf-8\"), algo.salt1]));\r\n    const hash2 = await (0, Helpers_1.sha256)(buffer_1.Buffer.concat([algo.salt2, hash1, algo.salt2]));\r\n    const hash3 = await pbkdf2sha512(hash2, algo.salt1, 100000);\r\n    return (0, Helpers_1.sha256)(buffer_1.Buffer.concat([algo.salt2, hash3, algo.salt2]));\r\n}\r\n/**\r\n *\r\n * @param algo {constructors.PasswordKdfAlgoSHA256SHA256PBKDF2HMACSHA512iter100000SHA256ModPow}\r\n * @param password\r\n */\r\nasync function computeDigest(algo, password) {\r\n    try {\r\n        checkPrimeAndGood(algo.p, algo.g);\r\n    }\r\n    catch (e) {\r\n        throw new Error(\"bad p/g in password\");\r\n    }\r\n    const value = (0, Helpers_1.modExp)((0, big_integer_1.default)(algo.g), (0, Helpers_1.readBigIntFromBuffer)(await computeHash(algo, password), false), (0, Helpers_1.readBigIntFromBuffer)(algo.p, false));\r\n    return bigNumForHash(value);\r\n}\r\nexports.computeDigest = computeDigest;\r\n/**\r\n *\r\n * @param request {constructors.account.Password}\r\n * @param password {string}\r\n */\r\nasync function computeCheck(request, password) {\r\n    const algo = request.currentAlgo;\r\n    if (!(algo instanceof\r\n        tl_1.Api.PasswordKdfAlgoSHA256SHA256PBKDF2HMACSHA512iter100000SHA256ModPow)) {\r\n        throw new Error(`Unsupported password algorithm ${algo === null || algo === void 0 ? void 0 : algo.className}`);\r\n    }\r\n    const srp_B = request.srp_B;\r\n    const srpId = request.srpId;\r\n    if (!srp_B || !srpId) {\r\n        throw new Error(`Undefined srp_b  ${request}`);\r\n    }\r\n    const pwHash = await computeHash(algo, password);\r\n    const p = (0, Helpers_1.readBigIntFromBuffer)(algo.p, false);\r\n    const g = algo.g;\r\n    const B = (0, Helpers_1.readBigIntFromBuffer)(srp_B, false);\r\n    try {\r\n        checkPrimeAndGood(algo.p, g);\r\n    }\r\n    catch (e) {\r\n        throw new Error(\"bad /g in password\");\r\n    }\r\n    if (!isGoodLarge(B, p)) {\r\n        throw new Error(\"bad b in check\");\r\n    }\r\n    const x = (0, Helpers_1.readBigIntFromBuffer)(pwHash, false);\r\n    const pForHash = numBytesForHash(algo.p);\r\n    const gForHash = bigNumForHash((0, big_integer_1.default)(g));\r\n    const bForHash = numBytesForHash(srp_B);\r\n    const gX = (0, Helpers_1.modExp)((0, big_integer_1.default)(g), x, p);\r\n    const k = (0, Helpers_1.readBigIntFromBuffer)(await (0, Helpers_1.sha256)(buffer_1.Buffer.concat([pForHash, gForHash])), false);\r\n    const kgX = (0, Helpers_1.bigIntMod)(k.multiply(gX), p);\r\n    const generateAndCheckRandom = async () => {\r\n        const randomSize = 256;\r\n        // eslint-disable-next-line no-constant-condition\r\n        while (true) {\r\n            const random = (0, Helpers_1.generateRandomBytes)(randomSize);\r\n            const a = (0, Helpers_1.readBigIntFromBuffer)(random, false);\r\n            const A = (0, Helpers_1.modExp)((0, big_integer_1.default)(g), a, p);\r\n            if (isGoodModExpFirst(A, p)) {\r\n                const aForHash = bigNumForHash(A);\r\n                const u = (0, Helpers_1.readBigIntFromBuffer)(await (0, Helpers_1.sha256)(buffer_1.Buffer.concat([aForHash, bForHash])), false);\r\n                if (u.greater((0, big_integer_1.default)(0))) {\r\n                    return {\r\n                        a: a,\r\n                        aForHash: aForHash,\r\n                        u: u,\r\n                    };\r\n                }\r\n            }\r\n        }\r\n    };\r\n    const { a, aForHash, u } = await generateAndCheckRandom();\r\n    const gB = (0, Helpers_1.bigIntMod)(B.subtract(kgX), p);\r\n    if (!isGoodModExpFirst(gB, p)) {\r\n        throw new Error(\"bad gB\");\r\n    }\r\n    const ux = u.multiply(x);\r\n    const aUx = a.add(ux);\r\n    const S = (0, Helpers_1.modExp)(gB, aUx, p);\r\n    const [K, pSha, gSha, salt1Sha, salt2Sha] = await Promise.all([\r\n        (0, Helpers_1.sha256)(bigNumForHash(S)),\r\n        (0, Helpers_1.sha256)(pForHash),\r\n        (0, Helpers_1.sha256)(gForHash),\r\n        (0, Helpers_1.sha256)(algo.salt1),\r\n        (0, Helpers_1.sha256)(algo.salt2),\r\n    ]);\r\n    const M1 = await (0, Helpers_1.sha256)(buffer_1.Buffer.concat([\r\n        xor(pSha, gSha),\r\n        salt1Sha,\r\n        salt2Sha,\r\n        aForHash,\r\n        bForHash,\r\n        K,\r\n    ]));\r\n    return new tl_1.Api.InputCheckPasswordSRP({\r\n        srpId: srpId,\r\n        A: buffer_1.Buffer.from(aForHash),\r\n        M1: M1,\r\n    });\r\n}\r\nexports.computeCheck = computeCheck;\r\n"],"mappings":"AAAA,YAAY;;AACZ,IAAIA,eAAe,GAAI,IAAI,IAAI,IAAI,CAACA,eAAe,IAAK,UAAUC,GAAG,EAAE;EACnE,OAAQA,GAAG,IAAIA,GAAG,CAACC,UAAU,GAAID,GAAG,GAAG;IAAE,SAAS,EAAEA;EAAI,CAAC;AAC7D,CAAC;AACDE,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAAEC,KAAK,EAAE;AAAK,CAAC,CAAC;AAC7DD,OAAO,CAACE,aAAa,GAAGF,OAAO,CAACG,YAAY,GAAG,KAAK,CAAC;AACrD,MAAMC,QAAQ,GAAGC,OAAO,CAAC,SAAS,CAAC;AACnC,MAAMC,IAAI,GAAGD,OAAO,CAAC,MAAM,CAAC;AAC5B,MAAME,SAAS,GAAGF,OAAO,CAAC,WAAW,CAAC;AACtC,MAAMG,aAAa,GAAGb,eAAe,CAACU,OAAO,CAAC,aAAa,CAAC,CAAC;AAC7D,MAAMI,YAAY,GAAGd,eAAe,CAACU,OAAO,CAAC,cAAc,CAAC,CAAC;AAC7D,MAAMK,aAAa,GAAG,GAAG;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASC,iBAAiBA,CAACC,UAAU,EAAEC,CAAC,EAAE;EACtC,MAAMC,SAAS,GAAGV,QAAQ,CAACW,MAAM,CAACC,IAAI,CAAC,CACnC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EACtE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EACtE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EACtE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EACtE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EACtE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EACtE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EACtE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EACtE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EACtE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EACtE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EACtE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EA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"},"metadata":{},"sourceType":"script","externalDependencies":[]}